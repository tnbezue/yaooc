<!DOCTYPE html>
<!--
  Copyright (C) 2016-2019  by Terry N Bezue

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <https://www.gnu.org/licenses/>.
-->
<html>
<head>
<title>Custom Class</title>
<meta name="generator" content="Bluefish 2.2.10" >
<meta name="copyright" content="">
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8">
<meta http-equiv="content-style-type" content="text/css">
<meta http-equiv="expires" content="0">
<link href="yaooc.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="yaooc.js"></script>
</head>
<body>
<div id="wrapper">
<script>header();</script>
<script>menu();</script>
<div id="content" class="content">
<div style="overflow-y: scroll; height:900px">
<h2>Custom Class</h2>
<p>
Over the next few lessons a custom class will be created.  The class will be a simple string class.
This is meant to show the features of YAOOC rather than good programming practice.
</p>
<p>
A custom class starts with a structure.  For the simple string class (let's call it my_string), it is as follows:
</p>
<pre><code>
  struct my_string_s {
    char* str;
  };
</code></pre>
<p>
While structures can be defined using the above, it's better to use the macros provided by YAOOC.
</p>
<pre><code>
  yaooc_struct(my_string) {
    char* str;
  };
</code></pre>

<p>
The yaooc_struct macro creates the same structure.  It also creates code
that defines supporting types.  For my_string class, the following code is created:
</p>
<pre><code>
  typedef struct my_string_s my_string_t;
  typedef my_string_t const * my_string_pointer;
  typedef const my_string_t const * my_string_const_pointer;
  extern const type_info_t __my_string_ti;
  extern const type_info_t* const my_string_ti;
  struct my_string_s {
    char* str;
  };
</code></pre>
<h3>Important Requirement</h3>
<p>
Before continuing with the my_string class, one important requirement for custom classes -- class instances must be movable.  For example:
</p>
<pre><code>
  yaooc_struct(circular_buffer) {
    char* beg;
    char* end;
    char buffer[32];
  };
</code></pre>
<p>
In the above example, if beg and end are pointers to locations within buffer, then the pointers would be invalidated if the object is
moved to a different memory location -- thus it is an immovable object.
</p>
<p>
If the class was defined as:
</p>
<pre><code>
  yaooc_struct(circular_buffer) {
    char* beg;
    char* end;
    char* buffer;
  };
</code></pre>
<p>
If beg and end are pointers to memory within memory pointed to by buffer, then moving the object will not invalidate the pointers -- thus it is a movable object.
</p>
</div>
</div>
</div>
</body>
</html>
