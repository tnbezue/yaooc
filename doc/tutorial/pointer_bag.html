<!DOCTYPE html>
<html>
<head>
<title>Pointer Bag</title>
<meta name="generator" content="Bluefish 2.2.10" >
<meta name="copyright" content="">
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8">
<meta http-equiv="content-style-type" content="text/css">
<meta http-equiv="expires" content="0">
<link href="yaooc.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="yaooc.js"></script>
</head>
<body>
<div id="wrapper">
<script>header();</script>
<script>menu();</script>
<div id="content" class="content">
<div style="overflow-y: scroll; height:900px">
<h2>Pointer Bag</h2>

<p>
With C++, pointers can be wrapped in a smart pointer so that when it goes out of scope, the object is deleted.
</p>
<p>
In YAOOC, the pointer bag serves a similar purpose.  When objects are created with new, it can be stored in the pointer bag.
When the pointer bag is deleted, all pointers in bag are deleted as well.  Pointers stored in pointer bag must have been
created using new.  Pointers created using malloc should not be stored in the pointer bag.
</p>
<pre><code>
  #include &lt;yaooc/pointer_bag.h&gt;
  ...
  void some_method() {
    pointer_bag_pointer bp=new(pointer_bag);
  
    my_string_pointer sp=M(pb,save,new(my_string));
    ...
    char *temp = M(pb,save,new_array(char,128));
    ...
    sp=M(pb,save,new_ctor(my_string,my_string_ctor_ccs,"This will be deleted when pointer bag is deleted"));
    ...
    delete(pb);
  }
</code></pre>

<p>
YAOOC provides the following macros for using pointer bags.
</p>

<div class="divTable">
<div class="divTableBody">
<div class="divTableRow">
<div class="divTableHead">Macro</div>
<div class="divTableHead">Purpose</div>
</div>
<div class="divTableRow">
<div class="divTableCell">PB_INIT</div>
<div class="divTableCell">Create a new pointer bag called local_pb</div>
</div>
<div class="divTableRow">
<div class="divTableCell">PB_SAVE(ptr)</div>
<div class="divTableCell">Save pointer in pointer bag and returns value being saved</div>
</div>
<div class="divTableRow">
<div class="divTableCell">PB_CLEAR</div>
<div class="divTableCell">Removes pointers from pointer bag without deleting pointers</div>
</div>
<div class="divTableRow">
<div class="divTableCell">PB_DELETE</div>
<div class="divTableCell">Deletes pointers in pointer bag.  More pointer can still be saved</div>
</div>
<div class="divTableRow">
<div class="divTableCell">PB_EXIT</div>
<div class="divTableCell">Deletes pointers in pointer bag and destroys pointer bag.</div>
</div>
</div>
</div>

<p>
Generally, PB_INIT is specified at the beginning of a method.  PB_SAVE is used to save pointer within the method. PB_EXIT is used before
exiting method.
</p>

<pre><code>
  void some_method() {
    PB_INIT;
  
    my_string_pointer sp=PB_SAVE(new(my_string));
    ...
    char *temp = PB_SAVE(new_array(char,128));
    ...
    sp=PB_SAVE(new_ctor(my_string,my_string_ctor_ccs,"This will be deleted when pointer bag is deleted"));
    ...
    PB_EXIT;
  }
</code></pre>

</div>
</div>
</div>
</body>
</html>