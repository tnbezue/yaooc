<!DOCTYPE html>
<!--
  Copyright (C) 2016-2019  by Terry N Bezue

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <https://www.gnu.org/licenses/>.
-->
<html>
<head>
<title>Class Methods</title>
<meta name="generator" content="Bluefish 2.2.10" >
<meta name="copyright" content="">
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8">
<meta http-equiv="content-style-type" content="text/css">
<meta http-equiv="expires" content="0">
<link href="yaooc.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="yaooc.js"></script>
</head>
<body>
<div id="wrapper">
<script>header();</script>
<script>menu();</script>
<div id="content" class="content">
<div style="overflow-y: scroll; height:900px">
<h2>Class Methods</h2>
<p>
In this lesson the my_string class will be improved by adding two class methods. In order to have class methods,
<font color="red">&quot;%class&quot;</font> will be used rather than <font color="red">&quot;%struct&quot;</font> to define a class.
</p>
<p>
For the my_string class, a get and set method will be defined.  The get method returns a const pointer to the string and the set method sets the string.
</p>
<pre><code>
  %class my_string {
    ....
  instance:
    char* str;
  table:
    const char* get() const // method name will be my_string_get
    {
      return this-&gt;str;
    }

    void set(const char* s)
    {
      my_string_dtor(this);
      this-&gtstr = s==NULL ? NULL : strdup(s);
    }
  };
</code></pre>
<p>
Methods and variables appearing after &quot;table:&quot; will be placed in the class table.  Items in class table are shared by all instances
of object.
</p>
<p>
In C++, structs and classes are basically the same. In YAOOC, &quot;%struct&quot; and &quot;%class&quot; are different. &quot;%struct&quot; does not have a class table.
</p>
<p>
<font color="red">Never use memset(this,0,sizeof(T)) to initialize an object.</font> The first entry in the object is a pointer to the class table,
using memset will destroy the value of the class table.
</p>
<p>
To call a class table method, use the M macro (M for method). The syntax is M(ptr,method,args). Of course, the args portion should not be specified if a method does not have any arguments.
</p>
<pre><code>
  M(msp,set,"This is a test");
  printf("%s\n",M(msp,get));
</code></pre>
<p>
To see various uses of the M macro, see the test files in the tests directory.
</p>
<h3>Forward declaration of class</h3>
<p>
In C++, a class can have a forward declaration.
</p>
<pre><code>
  class my_string_t;
</code></pre>
<p>
This can also be done in YAOOC.
</p>
<pre><code>
  %class my_string;
</code></pre>

</div>
</div>
</div>
</body>
</html>
